---
import { getCollection } from 'astro:content';
import Base from '../layouts/Base.astro';
import PostCard from '../components/PostCard.astro';

const posts = await getCollection('posts', ({ data }) => !data.draft);
const categories = ['Yocto','Zephyr','Embedded Linux','RTOS','Drivers','CI/CD','QQQ'];
---
<Base title="Projects â€” EmbeddedTech">
  <section class="container py-10">
    <h1 class="text-3xl font-bold">Projects</h1>
    <p class="text-white/70 mt-2">Categories</p>

    {categories.map((cat) => {
      const items = posts.filter((p) => p.data.categories?.includes(cat));
      return items.length ? (
        <div class="mt-8" id={cat.replace(/\s+/g,'-')}>
          <h2 class="text-xl font-semibold">{cat}</h2>
          <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-4">
            {items.map((post) => (
              <PostCard
                href={`/posts/${post.slug}/`}
                title={post.data.title}
                description={post.data.description}
                pubDate={post.data.pubDate}
                categories={post.data.categories}
                heroImage={post.data.heroImage}
              />
            ))}
          </div>
        </div>
      ) : null;
    })}
  </section>
</Base>
